<html>

<body>
  <div>
    <p>Bitte um einen Moment Geduld,...</p>
    <p id="error"></p>
  </div>
</body>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<script src="https://js.stripe.com/v3/"></script>

<script type="text/javascript" language="javascript">
  var urlParams = new URLSearchParams(window.location.search);

  var emailParam = urlParams.get('email');
  var membernameParam = urlParams.get('membername');

  $.ajax({
    url: 'http://localhost:3000/stripe/checkout-session',
    data: {
      email: emailParam,
      membername: membernameParam
    },
    success: async function (sessionid) {
      console.trace(`Stripe Session: ${sessionid}`);

      const stripe = Stripe('pk_test_L5QziXygGTAQitDtuUXMDzyC00JQpb7Tbs');
      const error = await stripe.redirectToCheckout({
        sessionId: sessionid,
      })

      $("#error").html(error);
    }
  })
</script>

</html>
